<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	
	<title>How to design an API Client Library</title>
	
	<meta name="description" content="How to design an API Client Library">
	<meta name="author" content="Kevin Burke">
	<meta name="viewport" content="width=1024, user-scalable=no">
	
	<!-- Core and extension CSS files -->
	<link rel="stylesheet" href="/slides/static/core/deck.core.css">
	<link rel="stylesheet" href="/slides/static/extensions/goto/deck.goto.css">
	<link rel="stylesheet" href="/slides/static/extensions/menu/deck.menu.css">
	<link rel="stylesheet" href="/slides/static/extensions/navigation/deck.navigation.css">
	<link rel="stylesheet" href="/slides/static/extensions/status/deck.status.css">
	<link rel="stylesheet" href="/slides/static/extensions/hash/deck.hash.css">
	<link rel="stylesheet" href="/slides/static/extensions/scale/deck.scale.css">
	
	<!-- Style theme. More available in /themes/style/ or create your own. -->
	<link rel="stylesheet" href="/slides/static/themes/style/swiss.css">
	
	<!-- Transition theme. More available in /themes/transition/ or create your own. -->
	<link rel="stylesheet" href="/slides/static/themes/transition/horizontal-slide.css">
	
	<script src="/slides/static/modernizr.custom.js"></script>
	<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/slides/static/jquery-1.7.min.js"><\/script>')</script>
</head>

<body class="deck-container">

<!-- Begin slides -->
<section class="slide" id="title-slide">
	<h1>How to design an API Client Library</h1>
	<p style="position: absolute; bottom: 20px; right: 80px;"><a href="http://kev.inburke.com">Kevin Burke</a></p>
</section>

<section class="slide" id="caveat-emptor">
	<h2>This talk</h2>
  <ul>
    <li>The problem</li>
    <li>Finding a solution</li>
    <li>Lessons learned</li>
  </ul>
</section>

<section class="slide" id="caveat-emptor">
	<h1>The problem</h1>
</section>

<section class="slide" id="caveat-emptor">
	<h2>The problem</h2>
  <img src="pic of old-docs-snippet.jpg" />
</section>

<section class="slide" id="caveat-emptor">
	<h2>The problem</h2>
  <img src="pic-of-docs-snippet.jpg" />
</section>

<section class="slide" id="caveat-emptor">
	<h2>The problem</h2>
  <ul>
    <li>Accounts
    <li>Applications
    <li>AuthorizedConnectApps
    <li>AvailablePhoneNumbers
    <li>Calls
    <li>Updating Calls
    <li>Conferences
    <li>ConnectApps
    <li>IncomingPhoneNumbers
    <li>Making Calls
    <li>Members
    <li>Notifications
    <li>OutgoingCallerIds
    <li>Participants
    <li>Queues
    <li>Recordings
    <li>Sending SMS
    <li>ShortCodes
    <li>SmsMessages
    <li>Subaccounts
    <li>Transcriptions
    <li>UsageRecords
    <li>UsageTriggers
  </ul>
  </ul>
</section>

<section class="slide" id="caveat-emptor">
	<h2>The problem</h2>
  <h5>Multiply that by multiple examples per page, 6 snippets per example</h5>
</section>

<section class="slide" id="caveat-emptor">
	<h2>The problem</h2>
  <h5>That's a shitload of code snippets</h5>
  <img src="funny-pic.jpg" />
  <!-- Got tired after like the sixth one -->
</section>

<section class="slide" id="caveat-emptor">
	<h1>Finding a solution</h1>
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <img src="all-the-docs.jpg" />
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <h5>Okay, that won't work</h5>
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <pre>
  <code>
  GET /2010-04-01/Accounts/AC123/SMS/Messages
  From=%2B14105551234
  </code>
  </pre>
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <pre>
  <code>
  def process_instance_resource(self, resource, sid, method="GET", params=None):
      """ Generate code snippets for an instance resource """
      get_line = '{} = {}.get("{}")'.format(self.instance_name, self.base, sid)

      if method == "GET":
          interesting_line = 'print {}.{}'.format(
              self.instance_name,
              self.kw_rep(self.get_interesting_property(resource)))
          return "\n".join([get_line, interesting_line])

      ...
  </code>
  </pre>
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <pre>
  <code>
    instance_var_names = {
        '/Accounts': 'account',
        '/Applications': 'app',
        '/AuthorizedConnectApps': 'authorized_app',
        '/AvailablePhoneNumbers': 'available_number',
        '/Calls': 'call',
        ...
    }
  </code>
  </pre>
</section>

<section class="slide" id="caveat-emptor">
	<h2>Finding a solution</h2>
  <pre>
  <code>
    interesting_properties = {
        '/Accounts': ['friendly_name', 'status', 'date_created'],
        '/Applications': ['voice_url', 'sms_url'],
        '/AuthorizedConnectApps': ['connect_app_friendly_name',
                                   'connect_app_homepage_url'],
        '/AvailablePhoneNumbers': ['friendly_name', 'phone_number'],
        '/Calls': ['start_time', 'direction', 'to'],
        '/Conferences': ['status'],
        '/Conferences/Participants': ['start_conference_on_enter', 'muted'],
        '/ConnectApps': ['homepage_url', 'friendly_name'],
        ...
    }
  </code>
  </pre>
</section>

<section class="slide" id="how-many-can-we-find">
  <h2>How many can we expect to find?</h2>
  <h4>If you do it <i>well</i>: 70%</h4>
  <h4>If you do it <i>poorly</i>: 20%</h4>
</section>

<section class="slide" id="how-many-can-we-find">
  <h2>How many can we expect to find?</h2>
  <h4>If you do it <i>well</i>: 70%</h4>
  <h4>If you do it <i>poorly</i>: 20%</h4>
</section>

<section class="slide" id="different-types-of-review">
  <h2>Effectiveness of different bug-finding tools</h2>
  <div id="bug_chart" style="width: 100%; height: 80%; min-height: 600px;"></div>
  <!-- especially if they are stuck -->
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/flot/0.7/jquery.flot.min.js"></script>

  <script src="http://kev.inburke.com/code/graph.js" type="text/javascript"></script>
</section>

<section class="slide" id="error-distribution">
	<h2>How are errors distributed?</h2>
	<h5>In general, 80% of the errors come from 20% of the code.</h5>
	<h5>Also, 50% of errors from 5% of the code</h5>
	<p>Case study at IBM: 31 of 425 classes found to be error-prone. 
	After repair/refactoring, defects reported by customers were reduced by 1000%</p>
</section>

<section class="slide" id="pull-request-length">
  <h2>Pull request length</h2>
  <img src="https://img.skitch.com/20120531-g79ty5j6gqhmtue42rsc3um2hm.png" />
  <!-- especially if they are stuck -->
</section>

<section class="slide">
	<h2>Example</h2>
	<img src="https://img.skitch.com/20120531-1yg67hxtd6p2ujkx51ima3tbh6.png" />
</section>

<section class="slide" id="pull-request-habits">
	<h1>Longer pull requests take longer to get reviewed/merged (why?)</h1>
</section>

<section class="slide" id="code-review-speed">
	<h2>How quickly can you do code review?</h2>
	<h5>Estimates: 500 lines/hour for "application" code</h5>
	<h5>125 lines/hour for "system" code</h5>
	<h5>Attention span/effectiveness drops after 2 hours of review</h5>
	<h5>Start at 200 lines/hour</h5>
</section>

<section class="slide" id="pull-request-advice">
	<h2>Advice</h2>
	<ul>
		<li><h4>Limit the number of context switches your reviewers need to make</h4>
		<li><h4>Try to keep review time under 2 hours</h4>
		<li><h4>Note areas that have previously generated many bugs, and focus extra attention on them during review</h4>
		<li><h4>Take extra care with small changes (1-10 lines)</h4>
		<li><h4>Let machines help you (linting, static analysis, spell checking)</h4>
</section>

<section class="slide" id="kevin-track">
	<h2>Kevin Track</h2>
	<img src="https://img.skitch.com/20120531-phu6jwm11m5auhyugnc3y58jbu.png" alt="Spreadsheet with errors" />
</section>

<section class="slide" id="automated-linter">
	<h2>Git pre-commit hooks</h2>
	<pre><code>
              ,
          ,   |\ ,__
          |\   \/   `.
          \ `-.:.     `\
           `-.__ `\=====|
              /=`'/   ^_\
            .'   /\   .=)
         .-'  .'|  '-(/_|
       .'  __(  \  .'`
      /_.'`  `.  |`
               \ |
                |/
								</pre></code>
	<a href="http://twiliocode.com/kevin/trojan-man">source</a>
</section>

<section class="slide" id="thanks">
  <h2>Thanks!</h2>
  <h3>Kevin Burke</h3>
  <h4><a href="http://kev.inburke.com">kev.inburke.com</a></h4>
  <h4><a href="mailto:kevin@twilio.com">kevin@twilio.com</a></h4>
  <h4><a href="http://twitter.com/ekrubnivek">@ekrubnivek</a></h4><br/>
  <p>These slides are available at:</p>
  <h4><a href="http://kev.inburke.com/slides/pull-requests">kev.inburke.com/slides/pull-requests</a></h4>
</section>

<!-- deck.navigation snippet -->
<a href="#" class="deck-prev-link" title="Previous">&#8592;</a>
<a href="#" class="deck-next-link" title="Next">&#8594;</a>

<!-- deck.status snippet -->
<p class="deck-status">
	<span class="deck-status-current"></span>
	/
	<span class="deck-status-total"></span>
</p>

<!-- deck.goto snippet -->
<form action="." method="get" class="goto-form">
	<label for="goto-slide">Go to slide:</label>
	<input type="text" name="slidenum" id="goto-slide" list="goto-datalist">
	<datalist id="goto-datalist"></datalist>
	<input type="submit" value="Go">
</form>

<!-- deck.hash snippet -->
<a href="." title="Permalink to this slide" class="deck-permalink">#</a>



<!-- Deck Core and extensions -->
<script src="/slides/static/core/deck.core.js"></script>
<script src="/slides/static/extensions/hash/deck.hash.js"></script>
<script src="/slides/static/extensions/menu/deck.menu.js"></script>
<script src="/slides/static/extensions/goto/deck.goto.js"></script>
<script src="/slides/static/extensions/status/deck.status.js"></script>
<script src="/slides/static/extensions/navigation/deck.navigation.js"></script>
<script src="/slides/static/extensions/scale/deck.scale.js"></script>

<!-- Initialize the deck -->
<script>
$(function() {
	$.deck('.slide');
});
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-566397-2']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_trackPageLoadTime']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>

</body>
</html>
